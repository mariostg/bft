{% extends 'core/base.html' %}
{% load humanize %}
{% block title %}Cost Center Screening Report{% endblock title %}
{% block content %}
<main class='block block--centered'>
    {% if not table %}
    <div class="alert alert--info">There are no data to display</div>
    {% endif %}

    <h1>Cost Center Screening Report</h1>
    {% if form_filter %}
    {% include 'bmt-screening-report-form-filter.html' %}
    {% endif %}
{{table|safe}}
</main>

<script>
    var getSiblings = function (elem) {
        // Setup siblings array and get the first sibling
        var siblings = [];
        var sibling = elem.parentNode.firstChild;

        // Loop through each sibling and push to the array
        while (sibling) {
            if (sibling.nodeType === 1 && sibling !== elem) {
                siblings.push(sibling);
            }
            sibling = sibling.nextSibling;
        }

        return siblings;
    };

    function set_total_row_background(targetclass){
        fc = document.querySelectorAll("."+targetclass);
        fc.forEach((c) => {
            sibblings = getSiblings(c);
            sibblings.forEach((s) => {
                s.classList.add(targetclass);
            });
        });
    }

    //set the FUND centers class odd even
    //row_heading and level0 classes are generated by Pandas Pivot table
    tags = document.querySelectorAll(".row_heading.level0");
    odd = true;
    tags.forEach((t) => {
        t.classList.add(odd == false ? "fc-even" : "fc-odd");
        odd = !odd;
    });

    //Set the top row (totals) for each FUND centers
    set_total_row_background('fc-odd')
    set_total_row_background('fc-even')

    //set the COST centers class odd even
    tags = document.querySelectorAll(".row_heading.level1");
    odd = true;
    tags.forEach((t) => {
        if (t.innerHTML) {
            t.classList.add(odd == false ? "cc-even" : "cc-odd");
            odd = !odd;
        }
    });

    //Set the top row for each COST centers
    set_total_row_background('cc-odd')
    set_total_row_background('cc-even')

</script>

{% endblock content %}
